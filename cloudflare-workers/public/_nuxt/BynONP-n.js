import{s as ie,h as ue}from"./BKE9OddO.js";import{d as de,r as v,k as N,o as re,N as U,C as t,g as i,y as p,B as l,z as n,D as o,x as w,M as O,P as F,O as L,T as ve,U as _e,A as r,_ as me}from"./3wGxBOjn.js";const ce={class:"mb-4"},pe={class:"d-flex align-center"},fe={class:"mb-4"},ge={class:"d-flex align-center"},be={class:"mb-4"},xe={class:"d-flex align-center justify-space-between"},ke={class:"d-flex align-center"},ye={class:"flex-grow-1"},Ve={class:"text-subtitle-2"},Ce={class:"text-caption text-medium-emphasis"},Ie={class:"mb-4"},Ae={class:"d-flex gap-2 mb-4"},we={key:0,class:"conversion-result"},Pe={class:"converted-text"},Se={key:0,class:"mb-3"},ze={class:"text-caption"},$e={class:"d-flex gap-2"},Ge=de({__name:"AIConversionPanel",props:{modelValue:{type:String,default:""}},emits:["update:modelValue","converted","openConfig"],setup(Me,{emit:H}){const P=H,m=v("gemini"),f=v("gemini-2.5-flash"),c=v(""),g=v(!1),u=v(null),b=v(!1),x=v(!1),S=v(!1),z=v(""),C=v([{value:"gemini",label:"Google Gemini",icon:"mdi-google",hint:"AIzaSy开头，约39字符",models:[{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro"}],defaultModel:"gemini-2.5-flash"},{value:"deepseek",label:"DeepSeek",icon:"mdi-brain",hint:"sk-开头，30-50字符",models:[{value:"deepseek-chat",label:"DeepSeek V3"},{value:"deepseek-reasoner",label:"DeepSeek R1"}],defaultModel:"deepseek-chat"}]),J=v([{title:"简单互联",description:"生产环境的数据中心内联接入区路由器1和路由器2与2台接入交换机全互联"},{title:"应用互访",description:"大观园生产机房的华为私有云上的客服应用访问花果山测试机房的阿里云上的订单应用"},{title:"多网互联",description:"生产环境的新街口和徐家汇两个数据中心的核心路由器通过专线连接，每个数据中心内部核心区域的2台核心路由器与2台核心交换机全互联"}]),D=N(()=>c.value.trim()&&z.value.trim()&&!g.value),q=N(()=>{const s=C.value.find(e=>e.value===m.value);return s?s.models:[]}),I=N(()=>C.value.find(s=>s.value===m.value)),Q=s=>{const e=C.value.find(d=>d.value===s);return e?e.label:s},K=async()=>{const s=I.value;s&&(f.value=s.defaultModel);const e=await W(m.value);z.value=e||"",S.value=!!e},W=async s=>{try{return localStorage.getItem(`ai_api_key_${s}`)}catch(e){return console.warn("获取存储的 API Key 失败:",e),null}},T=async()=>{if(D.value){g.value=!0,u.value=null;try{const e=await(await fetch("/api/ai/convert-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:m.value,api_key:z.value,natural_input:c.value,model_name:f.value})})).json();if(e.success)u.value=e.data,ie("AI转换完成");else throw new Error(e.error||"转换失败")}catch(s){ue(s,{action:"convertText",provider:m.value,inputLength:c.value.length})}finally{g.value=!1}}},X=()=>{u.value&&(P("update:modelValue",u.value.converted_text),P("converted",u.value),u.value=null,c.value="")},Y=()=>{u.value&&(P("update:modelValue",u.value.converted_text),u.value=null,c.value="")},Z=()=>{T()},h=s=>{c.value=s.description,x.value=!1};return re(()=>{K()}),(s,e)=>{const d=i("v-icon"),$=i("v-spacer"),_=i("v-btn"),G=i("v-card-title"),k=i("v-label"),ee=i("v-radio"),le=i("v-radio-group"),B=i("v-list-item"),te=i("v-select"),E=i("v-chip"),y=i("v-card"),ne=i("v-textarea"),A=i("v-card-text"),R=i("v-card-actions"),j=i("v-dialog"),oe=i("v-list-item-title"),ae=i("v-list-item-subtitle"),se=i("v-list");return p(),U(y,{class:"ai-conversion-panel",elevation:"2"},{default:t(()=>[l(G,{class:"d-flex align-center"},{default:t(()=>[l(d,{class:"mr-2",color:"primary"},{default:t(()=>e[11]||(e[11]=[o("mdi-robot")])),_:1,__:[11]}),e[13]||(e[13]=n("span",null,"🤖 AI智能转换",-1)),l($),l(_,{icon:"",size:"small",onClick:e[0]||(e[0]=a=>b.value=!0)},{default:t(()=>[l(d,null,{default:t(()=>e[12]||(e[12]=[o("mdi-help-circle-outline")])),_:1,__:[12]})]),_:1})]),_:1,__:[13]}),l(A,null,{default:t(()=>[n("div",ce,[l(k,{class:"mb-2"},{default:t(()=>e[14]||(e[14]=[o("AI模型选择：")])),_:1,__:[14]}),l(le,{modelValue:m.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>m.value=a),K],inline:"","hide-details":""},{default:t(()=>[(p(!0),w(L,null,F(C.value,a=>(p(),U(ee,{key:a.value,label:a.label,value:a.value},{label:t(()=>[n("div",pe,[l(d,{icon:a.icon,class:"mr-1",size:"small"},null,8,["icon"]),o(" "+r(a.label),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",fe,[l(k,{class:"mb-2"},{default:t(()=>e[15]||(e[15]=[o("模型选择：")])),_:1,__:[15]}),l(te,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),items:q.value,"item-title":"label","item-value":"value",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:a})=>{var V;return[n("div",ge,[l(d,{icon:(V=I.value)==null?void 0:V.icon,class:"mr-2",size:"small"},null,8,["icon"]),o(" "+r(a.title),1)])]}),item:t(({props:a,item:V})=>[l(B,ve(_e(a)),{prepend:t(()=>{var M;return[l(d,{icon:(M=I.value)==null?void 0:M.icon,class:"mr-2"},null,8,["icon"])]}),_:2},1040)]),_:1},8,["modelValue","items"])]),n("div",be,[n("div",xe,[l(k,null,{default:t(()=>e[16]||(e[16]=[o("AI配置状态：")])),_:1,__:[16]}),l(_,{color:"primary",variant:"outlined",size:"small",onClick:e[3]||(e[3]=a=>s.$emit("openConfig"))},{default:t(()=>[l(d,{icon:"mdi-cog",size:"small",class:"mr-1"}),e[17]||(e[17]=o(" 配置AI "))]),_:1,__:[17]})]),l(y,{variant:"outlined",class:"mt-2 pa-3"},{default:t(()=>{var a;return[n("div",ke,[l(d,{icon:(a=I.value)==null?void 0:a.icon,class:"mr-2"},null,8,["icon"]),n("div",ye,[n("div",Ve,r(Q(m.value)),1),n("div",Ce,r(f.value),1)]),l(E,{color:S.value?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[o(r(S.value?"已配置":"未配置"),1)]),_:1},8,["color"])])]}),_:1})]),n("div",Ie,[l(k,{class:"mb-2"},{default:t(()=>e[18]||(e[18]=[o("自然语言输入：")])),_:1,__:[18]}),l(ne,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=a=>c.value=a),placeholder:"请用自然语言描述您的网络拓扑，例如：生产环境的亦庄数据中心内联接入区路由器1和路由器2与接入交换机全互联...",variant:"outlined",rows:"4","auto-grow":"","hide-details":"",class:"natural-input"},null,8,["modelValue"])]),n("div",Ae,[l(_,{color:"primary",loading:g.value,disabled:!D.value,onClick:T},{default:t(()=>[l(d,{start:""},{default:t(()=>e[19]||(e[19]=[o("mdi-auto-fix")])),_:1,__:[19]}),e[20]||(e[20]=o(" AI转换 "))]),_:1,__:[20]},8,["loading","disabled"]),l(_,{variant:"outlined",onClick:e[5]||(e[5]=a=>x.value=!0)},{default:t(()=>[l(d,{start:""},{default:t(()=>e[21]||(e[21]=[o("mdi-text-box-multiple")])),_:1,__:[21]}),e[22]||(e[22]=o(" 示例 "))]),_:1,__:[22]}),l(_,{variant:"outlined",onClick:e[6]||(e[6]=a=>b.value=!0)},{default:t(()=>[l(d,{start:""},{default:t(()=>e[23]||(e[23]=[o("mdi-help-circle")])),_:1,__:[23]}),e[24]||(e[24]=o(" 帮助 "))]),_:1,__:[24]})]),u.value?(p(),w("div",we,[l(k,{class:"mb-2"},{default:t(()=>e[25]||(e[25]=[o("转换结果预览：")])),_:1,__:[25]}),l(y,{variant:"outlined",class:"mb-3"},{default:t(()=>[l(A,null,{default:t(()=>[n("pre",Pe,r(u.value.converted_text),1)]),_:1})]),_:1}),u.value.validation?(p(),w("div",Se,[l(E,{color:u.value.validation.is_valid?"success":"warning",size:"small",variant:"tonal",class:"mr-2"},{default:t(()=>[l(d,{start:""},{default:t(()=>[o(r(u.value.validation.is_valid?"mdi-check-circle":"mdi-alert-circle"),1)]),_:1}),o(" "+r(u.value.validation.is_valid?"格式正确":"格式警告"),1)]),_:1},8,["color"]),n("span",ze," 有效行数: "+r(u.value.validation.valid_lines||0)+" / 总行数: "+r(u.value.validation.total_lines||0),1)])):O("",!0),n("div",$e,[l(_,{color:"success",onClick:X},{default:t(()=>[l(d,{start:""},{default:t(()=>e[26]||(e[26]=[o("mdi-check")])),_:1,__:[26]}),e[27]||(e[27]=o(" 确认使用 "))]),_:1,__:[27]}),l(_,{variant:"outlined",onClick:Y},{default:t(()=>[l(d,{start:""},{default:t(()=>e[28]||(e[28]=[o("mdi-pencil")])),_:1,__:[28]}),e[29]||(e[29]=o(" 手动编辑 "))]),_:1,__:[29]}),l(_,{variant:"outlined",onClick:Z,loading:g.value},{default:t(()=>[l(d,{start:""},{default:t(()=>e[30]||(e[30]=[o("mdi-refresh")])),_:1,__:[30]}),e[31]||(e[31]=o(" 重新生成 "))]),_:1,__:[31]},8,["loading"])])])):O("",!0)]),_:1}),l(j,{modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=a=>b.value=a),"max-width":"600"},{default:t(()=>[l(y,null,{default:t(()=>[l(G,null,{default:t(()=>e[32]||(e[32]=[o("AI智能转换帮助")])),_:1,__:[32]}),l(A,null,{default:t(()=>e[33]||(e[33]=[n("h4",null,"功能说明：",-1),n("p",null,"AI智能转换可以将您的自然语言描述转换为标准的网络拓扑格式。",-1),n("h4",null,"支持的AI模型：",-1),n("ul",null,[n("li",null,[n("strong",null,"Google Gemini"),o(": Google的多模态大语言模型")]),n("li",null,[n("strong",null,"DeepSeek"),o(": 专注于代码和推理的大语言模型")])],-1),n("h4",null,"使用步骤：",-1),n("ol",null,[n("li",null,"选择AI模型"),n("li",null,"配置对应的API Key"),n("li",null,"输入自然语言描述"),n("li",null,'点击"AI转换"'),n("li",null,"确认转换结果")],-1),n("h4",null,"输入示例：",-1),n("p",null,'"生产环境的亦庄数据中心内联接入区路由器1和路由器2与接入交换机全互联"',-1)])),_:1,__:[33]}),l(R,null,{default:t(()=>[l($),l(_,{onClick:e[7]||(e[7]=a=>b.value=!1)},{default:t(()=>e[34]||(e[34]=[o("关闭")])),_:1,__:[34]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:x.value,"onUpdate:modelValue":e[10]||(e[10]=a=>x.value=a),"max-width":"700"},{default:t(()=>[l(y,null,{default:t(()=>[l(G,null,{default:t(()=>e[35]||(e[35]=[o("输入示例")])),_:1,__:[35]}),l(A,null,{default:t(()=>[l(se,null,{default:t(()=>[(p(!0),w(L,null,F(J.value,(a,V)=>(p(),U(B,{key:V,onClick:M=>h(a),class:"example-item"},{default:t(()=>[l(oe,null,{default:t(()=>[o(r(a.title),1)]),_:2},1024),l(ae,null,{default:t(()=>[o(r(a.description),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),l(R,null,{default:t(()=>[l($),l(_,{onClick:e[9]||(e[9]=a=>x.value=!1)},{default:t(()=>e[36]||(e[36]=[o("关闭")])),_:1,__:[36]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),De=me(Ge,[["__scopeId","data-v-b6d9058e"]]);export{De as default};
