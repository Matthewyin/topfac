import{s as de,h as re}from"./a_CJwwmq.js";import{d as ve,r as v,k as M,o as _e,M as N,C as t,g as i,y as p,B as l,z as n,D as o,x as P,L as O,O as F,N as H,S as me,T as ce,A as r,_ as pe}from"./DzxsBtto.js";const fe={class:"mb-4"},ge={class:"d-flex align-center"},be={class:"mb-4"},xe={class:"d-flex align-center"},ke={class:"mb-4"},ye={class:"d-flex align-center justify-space-between"},Ce={class:"d-flex align-center"},Ve={class:"flex-grow-1"},Ie={class:"text-subtitle-2"},Ae={class:"text-caption text-medium-emphasis"},we={class:"mb-4"},Se={class:"d-flex gap-2 mb-4"},Pe={key:0,class:"conversion-result"},ze={class:"converted-text"},$e={key:0,class:"mb-3"},Ke={class:"text-caption"},Ge={class:"d-flex gap-2"},Me=ve({__name:"AIConversionPanel",props:{modelValue:{type:String,default:""}},emits:["update:modelValue","converted","openConfig"],setup(Ne,{expose:J,emit:q}){const z=q;J({refreshConfigStatus:Y});const _=v("gemini"),f=v("gemini-2.5-flash"),c=v(""),g=v(!1),u=v(null),b=v(!1),x=v(!1),k=v(!1),I=v(""),A=v([{value:"gemini",label:"Google Gemini",icon:"mdi-google",hint:"AIzaSy开头，约39字符",models:[{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro"}],defaultModel:"gemini-2.5-flash"},{value:"deepseek",label:"DeepSeek",icon:"mdi-brain",hint:"sk-开头，30-50字符",models:[{value:"deepseek-chat",label:"DeepSeek V3"},{value:"deepseek-reasoner",label:"DeepSeek R1"}],defaultModel:"deepseek-chat"}]),Q=v([{title:"简单互联",description:"生产环境的数据中心内联接入区路由器1和路由器2与2台接入交换机全互联"},{title:"应用互访",description:"大观园生产机房的华为私有云上的客服应用访问花果山测试机房的阿里云上的订单应用"},{title:"多网互联",description:"生产环境的新街口和徐家汇两个数据中心的核心路由器通过专线连接，每个数据中心内部核心区域的2台核心路由器与2台核心交换机全互联"}]),D=M(()=>c.value.trim()&&I.value.trim()&&!g.value),W=M(()=>{const s=A.value.find(e=>e.value===_.value);return s?s.models:[]}),w=M(()=>A.value.find(s=>s.value===_.value)),X=s=>{const e=A.value.find(d=>d.value===s);return e?e.label:s},T=async()=>{const s=w.value;s&&(f.value=s.defaultModel);const e=await U(_.value);I.value=e||"",k.value=!!e},U=async s=>{try{return localStorage.getItem(`ai_api_key_${s}`)}catch(e){return console.warn("获取存储的 API Key 失败:",e),null}},Y=async()=>{const s=await U(_.value);I.value=s||"",k.value=!!s,console.log("AI配置状态已刷新:",{provider:_.value,hasKey:k.value})},B=async()=>{if(D.value){g.value=!0,u.value=null;try{const e=await(await fetch("/api/ai/convert-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:_.value,api_key:I.value,natural_input:c.value,model_name:f.value})})).json();if(e.success)u.value=e.data,de("AI转换完成");else throw new Error(e.error||"转换失败")}catch(s){re(s,{action:"convertText",provider:_.value,inputLength:c.value.length})}finally{g.value=!1}}},Z=()=>{u.value&&(z("update:modelValue",u.value.converted_text),z("converted",u.value),u.value=null,c.value="")},h=()=>{u.value&&(z("update:modelValue",u.value.converted_text),u.value=null,c.value="")},ee=()=>{B()},le=s=>{c.value=s.description,x.value=!1};return _e(()=>{T()}),(s,e)=>{const d=i("v-icon"),$=i("v-spacer"),m=i("v-btn"),K=i("v-card-title"),y=i("v-label"),te=i("v-radio"),ne=i("v-radio-group"),E=i("v-list-item"),oe=i("v-select"),R=i("v-chip"),C=i("v-card"),ae=i("v-textarea"),S=i("v-card-text"),j=i("v-card-actions"),L=i("v-dialog"),se=i("v-list-item-title"),ie=i("v-list-item-subtitle"),ue=i("v-list");return p(),N(C,{class:"ai-conversion-panel",elevation:"2"},{default:t(()=>[l(K,{class:"d-flex align-center"},{default:t(()=>[l(d,{class:"mr-2",color:"primary"},{default:t(()=>e[11]||(e[11]=[o("mdi-robot")])),_:1,__:[11]}),e[13]||(e[13]=n("span",null,"🤖 AI智能转换",-1)),l($),l(m,{icon:"",size:"small",onClick:e[0]||(e[0]=a=>b.value=!0)},{default:t(()=>[l(d,null,{default:t(()=>e[12]||(e[12]=[o("mdi-help-circle-outline")])),_:1,__:[12]})]),_:1})]),_:1,__:[13]}),l(S,null,{default:t(()=>[n("div",fe,[l(y,{class:"mb-2"},{default:t(()=>e[14]||(e[14]=[o("AI模型选择：")])),_:1,__:[14]}),l(ne,{modelValue:_.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>_.value=a),T],inline:"","hide-details":""},{default:t(()=>[(p(!0),P(H,null,F(A.value,a=>(p(),N(te,{key:a.value,label:a.label,value:a.value},{label:t(()=>[n("div",ge,[l(d,{icon:a.icon,class:"mr-1",size:"small"},null,8,["icon"]),o(" "+r(a.label),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",be,[l(y,{class:"mb-2"},{default:t(()=>e[15]||(e[15]=[o("模型选择：")])),_:1,__:[15]}),l(oe,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),items:W.value,"item-title":"label","item-value":"value",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:a})=>{var V;return[n("div",xe,[l(d,{icon:(V=w.value)==null?void 0:V.icon,class:"mr-2",size:"small"},null,8,["icon"]),o(" "+r(a.title),1)])]}),item:t(({props:a,item:V})=>[l(E,me(ce(a)),{prepend:t(()=>{var G;return[l(d,{icon:(G=w.value)==null?void 0:G.icon,class:"mr-2"},null,8,["icon"])]}),_:2},1040)]),_:1},8,["modelValue","items"])]),n("div",ke,[n("div",ye,[l(y,null,{default:t(()=>e[16]||(e[16]=[o("AI配置状态：")])),_:1,__:[16]}),l(m,{color:"primary",variant:"outlined",size:"small",onClick:e[3]||(e[3]=a=>s.$emit("openConfig"))},{default:t(()=>[l(d,{icon:"mdi-cog",size:"small",class:"mr-1"}),e[17]||(e[17]=o(" 配置AI "))]),_:1,__:[17]})]),l(C,{variant:"outlined",class:"mt-2 pa-3"},{default:t(()=>{var a;return[n("div",Ce,[l(d,{icon:(a=w.value)==null?void 0:a.icon,class:"mr-2"},null,8,["icon"]),n("div",Ve,[n("div",Ie,r(X(_.value)),1),n("div",Ae,r(f.value),1)]),l(R,{color:k.value?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[o(r(k.value?"已配置":"未配置"),1)]),_:1},8,["color"])])]}),_:1})]),n("div",we,[l(y,{class:"mb-2"},{default:t(()=>e[18]||(e[18]=[o("自然语言输入：")])),_:1,__:[18]}),l(ae,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=a=>c.value=a),placeholder:"请用自然语言描述您的网络拓扑，例如：生产环境的亦庄数据中心内联接入区路由器1和路由器2与接入交换机全互联...",variant:"outlined",rows:"4","auto-grow":"","hide-details":"",class:"natural-input"},null,8,["modelValue"])]),n("div",Se,[l(m,{color:"primary",loading:g.value,disabled:!D.value,onClick:B},{default:t(()=>[l(d,{start:""},{default:t(()=>e[19]||(e[19]=[o("mdi-auto-fix")])),_:1,__:[19]}),e[20]||(e[20]=o(" AI转换 "))]),_:1,__:[20]},8,["loading","disabled"]),l(m,{variant:"outlined",onClick:e[5]||(e[5]=a=>x.value=!0)},{default:t(()=>[l(d,{start:""},{default:t(()=>e[21]||(e[21]=[o("mdi-text-box-multiple")])),_:1,__:[21]}),e[22]||(e[22]=o(" 示例 "))]),_:1,__:[22]}),l(m,{variant:"outlined",onClick:e[6]||(e[6]=a=>b.value=!0)},{default:t(()=>[l(d,{start:""},{default:t(()=>e[23]||(e[23]=[o("mdi-help-circle")])),_:1,__:[23]}),e[24]||(e[24]=o(" 帮助 "))]),_:1,__:[24]})]),u.value?(p(),P("div",Pe,[l(y,{class:"mb-2"},{default:t(()=>e[25]||(e[25]=[o("转换结果预览：")])),_:1,__:[25]}),l(C,{variant:"outlined",class:"mb-3"},{default:t(()=>[l(S,null,{default:t(()=>[n("pre",ze,r(u.value.converted_text),1)]),_:1})]),_:1}),u.value.validation?(p(),P("div",$e,[l(R,{color:u.value.validation.is_valid?"success":"warning",size:"small",variant:"tonal",class:"mr-2"},{default:t(()=>[l(d,{start:""},{default:t(()=>[o(r(u.value.validation.is_valid?"mdi-check-circle":"mdi-alert-circle"),1)]),_:1}),o(" "+r(u.value.validation.is_valid?"格式正确":"格式警告"),1)]),_:1},8,["color"]),n("span",Ke," 有效行数: "+r(u.value.validation.valid_lines||0)+" / 总行数: "+r(u.value.validation.total_lines||0),1)])):O("",!0),n("div",Ge,[l(m,{color:"success",onClick:Z},{default:t(()=>[l(d,{start:""},{default:t(()=>e[26]||(e[26]=[o("mdi-check")])),_:1,__:[26]}),e[27]||(e[27]=o(" 确认使用 "))]),_:1,__:[27]}),l(m,{variant:"outlined",onClick:h},{default:t(()=>[l(d,{start:""},{default:t(()=>e[28]||(e[28]=[o("mdi-pencil")])),_:1,__:[28]}),e[29]||(e[29]=o(" 手动编辑 "))]),_:1,__:[29]}),l(m,{variant:"outlined",onClick:ee,loading:g.value},{default:t(()=>[l(d,{start:""},{default:t(()=>e[30]||(e[30]=[o("mdi-refresh")])),_:1,__:[30]}),e[31]||(e[31]=o(" 重新生成 "))]),_:1,__:[31]},8,["loading"])])])):O("",!0)]),_:1}),l(L,{modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=a=>b.value=a),"max-width":"600"},{default:t(()=>[l(C,null,{default:t(()=>[l(K,null,{default:t(()=>e[32]||(e[32]=[o("AI智能转换帮助")])),_:1,__:[32]}),l(S,null,{default:t(()=>e[33]||(e[33]=[n("h4",null,"功能说明：",-1),n("p",null,"AI智能转换可以将您的自然语言描述转换为标准的网络拓扑格式。",-1),n("h4",null,"支持的AI模型：",-1),n("ul",null,[n("li",null,[n("strong",null,"Google Gemini"),o(": Google的多模态大语言模型")]),n("li",null,[n("strong",null,"DeepSeek"),o(": 专注于代码和推理的大语言模型")])],-1),n("h4",null,"使用步骤：",-1),n("ol",null,[n("li",null,"选择AI模型"),n("li",null,"配置对应的API Key"),n("li",null,"输入自然语言描述"),n("li",null,'点击"AI转换"'),n("li",null,"确认转换结果")],-1),n("h4",null,"输入示例：",-1),n("p",null,'"生产环境的亦庄数据中心内联接入区路由器1和路由器2与接入交换机全互联"',-1)])),_:1,__:[33]}),l(j,null,{default:t(()=>[l($),l(m,{onClick:e[7]||(e[7]=a=>b.value=!1)},{default:t(()=>e[34]||(e[34]=[o("关闭")])),_:1,__:[34]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(L,{modelValue:x.value,"onUpdate:modelValue":e[10]||(e[10]=a=>x.value=a),"max-width":"700"},{default:t(()=>[l(C,null,{default:t(()=>[l(K,null,{default:t(()=>e[35]||(e[35]=[o("输入示例")])),_:1,__:[35]}),l(S,null,{default:t(()=>[l(ue,null,{default:t(()=>[(p(!0),P(H,null,F(Q.value,(a,V)=>(p(),N(E,{key:V,onClick:G=>le(a),class:"example-item"},{default:t(()=>[l(se,null,{default:t(()=>[o(r(a.title),1)]),_:2},1024),l(ie,null,{default:t(()=>[o(r(a.description),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),l(j,null,{default:t(()=>[l($),l(m,{onClick:e[9]||(e[9]=a=>x.value=!1)},{default:t(()=>e[36]||(e[36]=[o("关闭")])),_:1,__:[36]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Ue=pe(Me,[["__scopeId","data-v-3a2c4c9b"]]);export{Ue as default};
