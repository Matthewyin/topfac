import{d as Z,r as V,J as G,k as K,P as O,M as Q,C as l,g as a,y as M,B as t,z as u,D as s,A as j,W as Y,x as h,L as ee,R as te,a as le,X as oe,_ as ne}from"./CBWR65Fw.js";const ae={class:"text-h5 font-weight-bold"},se={key:0,class:"text-caption text-grey-darken-1 mt-2"},ie={class:"format-help"},re=Z({__name:"ProjectDialog",props:{modelValue:{type:Boolean},project:{}},emits:["update:modelValue","saved"],setup(T,{emit:E}){const c=T,k=E,w=V(),v=V(!1),f=V(!1),_=V(!1),i=G({project_name:"",description:"",text_content:""}),p=K(()=>{var o;return!!((o=c.project)!=null&&o.id)}),F=[o=>!!o||"项目名称不能为空",o=>o&&o.length<=100||"项目名称不能超过100个字符",o=>/^[a-zA-Z0-9\u4e00-\u9fff\s\-_]+$/.test(o)||"项目名称只能包含字母、数字、中文、空格、横线和下划线"],S=[o=>!o||o.length<=500||"项目描述不能超过500个字符"],q=[o=>!o||o.length<=1e5||"文本内容不能超过100000个字符"],H=()=>`
- 【环境】【数据中心】的【区域】【设备】连接【环境】【数据中心】的【区域】【设备】
`,C=()=>{i.project_name="",i.description="",i.text_content=p.value?"":H(),oe(()=>{var o;(o=w.value)==null||o.resetValidation()})};O(()=>c.project,o=>{o?(i.project_name=o.project_name||"",i.description=o.description||"",i.text_content=o.text_content||""):C()},{immediate:!0});const y=()=>{k("update:modelValue",!1),C()},B=async()=>{var o,e;if(v.value){f.value=!0;try{const{$topologyApi:n}=le(),d={project_name:i.project_name.trim(),description:i.description.trim(),text_content:i.text_content.trim()};p.value&&((o=c.project)!=null&&o.id)?await n.projects.update(c.project.id,d):await n.projects.create(d),k("saved"),y()}catch(n){console.error("保存项目失败:",n);let d="保存项目失败，请稍后重试";(e=n==null?void 0:n.data)!=null&&e.error?d=n.data.error:n!=null&&n.message&&(d=n.message),alert(d)}finally{f.value=!1}}};return(o,e)=>{const n=a("v-icon"),d=a("v-spacer"),m=a("v-btn"),D=a("v-card-title"),R=a("v-divider"),I=a("v-text-field"),x=a("v-col"),U=a("v-textarea"),J=a("v-tooltip"),L=a("v-alert"),P=a("v-row"),W=a("v-form"),$=a("v-card-text"),N=a("v-card-actions"),A=a("v-card"),g=a("v-list-item-title"),b=a("v-list-item"),X=a("v-list"),z=a("v-dialog");return M(),Q(z,{"model-value":o.modelValue,"onUpdate:modelValue":e[8]||(e[8]=r=>o.$emit("update:modelValue",r)),"max-width":"800",persistent:""},{default:l(()=>[t(A,{class:"project-dialog"},{default:l(()=>[t(D,{class:"d-flex align-center"},{default:l(()=>[t(n,{class:"mr-3",color:"primary"},{default:l(()=>[s(j(p.value?"mdi-pencil":"mdi-plus"),1)]),_:1}),u("span",ae,j(p.value?"编辑项目":"创建新项目"),1),t(d),t(m,{icon:"mdi-close",variant:"text",onClick:y})]),_:1}),t(R),t($,{class:"pa-6"},{default:l(()=>[t(W,{ref_key:"formRef",ref:w,modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=r=>v.value=r),onSubmit:Y(B,["prevent"])},{default:l(()=>[t(P,null,{default:l(()=>[t(x,{cols:"12"},{default:l(()=>[t(I,{modelValue:i.project_name,"onUpdate:modelValue":e[0]||(e[0]=r=>i.project_name=r),label:"项目名称",placeholder:"请输入项目名称",variant:"outlined",rules:F,counter:100,required:"","prepend-inner-icon":"mdi-folder-outline"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12"},{default:l(()=>[t(U,{modelValue:i.description,"onUpdate:modelValue":e[1]||(e[1]=r=>i.description=r),label:"项目描述",placeholder:"请输入项目描述（可选）",variant:"outlined",rules:S,counter:500,rows:"3","auto-grow":"","prepend-inner-icon":"mdi-text"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12"},{default:l(()=>[t(U,{modelValue:i.text_content,"onUpdate:modelValue":e[3]||(e[3]=r=>i.text_content=r),label:p.value?"拓扑文本内容":"拓扑文本模板（可直接修改）",placeholder:p.value?"请输入网络拓扑描述文本":"已提供默认模板，您可以直接在此基础上修改",variant:"outlined",rules:q,rows:"12","auto-grow":"","prepend-inner-icon":"mdi-file-document-outline"},{"append-inner":l(()=>[t(J,{text:"查看文本格式说明"},{activator:l(({props:r})=>[t(m,te({icon:"mdi-help-circle-outline",variant:"text",size:"small"},r,{onClick:e[2]||(e[2]=de=>_.value=!0)}),null,16)]),_:1})]),_:1},8,["modelValue","label","placeholder"]),p.value?ee("",!0):(M(),h("div",se,e[9]||(e[9]=[s(" 💡 "),u("strong",null,"提示：",-1),s("已为您提供一个企业网络拓扑模板，您可以直接在此基础上修改，或者清空后重新编写 ")])))]),_:1}),t(x,{cols:"12"},{default:l(()=>[t(L,{type:"info",variant:"tonal",density:"compact",class:"text-body-2"},{prepend:l(()=>[t(n,null,{default:l(()=>e[10]||(e[10]=[s("mdi-information-outline")])),_:1,__:[10]})]),default:l(()=>[e[11]||(e[11]=u("strong",null,"提示：",-1)),e[12]||(e[12]=s(" 支持标准化的网络拓扑描述格式，包括区域定义、组件定义和连接关系。 可以在创建后继续编辑和完善。 "))]),_:1,__:[11,12]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(N,{class:"pa-6 pt-0"},{default:l(()=>[t(d),t(m,{variant:"text",onClick:y,disabled:f.value},{default:l(()=>e[13]||(e[13]=[s(" 取消 ")])),_:1,__:[13]},8,["disabled"]),t(m,{color:"primary",variant:"flat",loading:f.value,disabled:!v.value,onClick:B},{default:l(()=>[s(j(p.value?"保存更改":"创建项目"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),t(z,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=r=>_.value=r),"max-width":"600"},{default:l(()=>[t(A,null,{default:l(()=>[t(D,{class:"d-flex align-center"},{default:l(()=>[t(n,{class:"mr-3",color:"info"},{default:l(()=>e[14]||(e[14]=[s("mdi-help-circle")])),_:1,__:[14]}),e[15]||(e[15]=s(" 文本格式说明 ")),t(d),t(m,{icon:"mdi-close",variant:"text",onClick:e[5]||(e[5]=r=>_.value=!1)})]),_:1,__:[15]}),t(R),t($,{class:"pa-6"},{default:l(()=>[u("div",ie,[e[23]||(e[23]=u("h4",{class:"text-h6 mb-3"},"标准格式示例：",-1)),e[24]||(e[24]=u("div",{class:"format-example-text"},[u("p",{class:"text-body-2 mb-2"},[u("strong",null,"网络拓扑语言描述格式：")]),u("p",{class:"text-body-2 mb-1"},"- 【环境】【数据中心】的【区域】【设备】连接【环境】【数据中心】的【区域】【设备】 ")],-1)),e[25]||(e[25]=u("h4",{class:"text-h6 mt-6 mb-3"},"格式说明：",-1)),t(X,{density:"compact"},{default:l(()=>[t(b,null,{prepend:l(()=>[t(n,{color:"primary"},{default:l(()=>e[16]||(e[16]=[s("mdi-numeric-1-circle")])),_:1,__:[16]})]),default:l(()=>[t(g,null,{default:l(()=>e[17]||(e[17]=[s('每行以 "-" 开头描述一个连接关系')])),_:1,__:[17]})]),_:1}),t(b,null,{prepend:l(()=>[t(n,{color:"primary"},{default:l(()=>e[18]||(e[18]=[s("mdi-numeric-2-circle")])),_:1,__:[18]})]),default:l(()=>[t(g,null,{default:l(()=>e[19]||(e[19]=[s(" 使用【环境】【数据中心】的【区域】【设备】连接 ")])),_:1,__:[19]}),t(g,null,{default:l(()=>e[20]||(e[20]=[s(" 【环境】【数据中心】的【区域】【设备】格式 ")])),_:1,__:[20]})]),_:1}),t(b,null,{prepend:l(()=>[t(n,{color:"primary"},{default:l(()=>e[21]||(e[21]=[s("mdi-numeric-3-circle")])),_:1,__:[21]})]),default:l(()=>[t(g,null,{default:l(()=>e[22]||(e[22]=[s("设备名可以是主机名、应用名或网络设备名称")])),_:1,__:[22]})]),_:1})]),_:1})])]),_:1}),t(N,{class:"pa-6 pt-0"},{default:l(()=>[t(d),t(m,{color:"primary",variant:"flat",onClick:e[6]||(e[6]=r=>_.value=!1)},{default:l(()=>e[26]||(e[26]=[s(" 我知道了 ")])),_:1,__:[26]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model-value"])}}}),pe=ne(re,[["__scopeId","data-v-c4e6713f"]]);export{pe as default};
