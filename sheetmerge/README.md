# Excel Sheet Merger - 多Sheet页Excel合并工具

一个纯前端Web工具，用于将Excel文件中多个sheet页的内容按列合并，并输出为CSV文件。

## ✨ 特性

- 📁 **纯前端处理** - 所有数据处理在浏览器本地完成，无需服务器
- 🔒 **数据隐私** - 不上传任何数据到服务器
- 🎯 **简单易用** - 拖拽或点击上传，三步完成合并
- 🌐 **浏览器兼容** - 支持Chrome、Firefox、Safari、Edge
- 📊 **实时预览** - 合并前预览结果
- ⚙️ **灵活配置** - 自定义分隔符、选择合并列
- 🚀 **性能优化** - 支持大文件处理，不阻塞UI

## 🚀 快速开始

### 使用方法

1. **打开应用**
   - 双击 `index.html` 文件
   - 或在浏览器中打开该文件

2. **上传Excel文件**
   - 点击上传区域或拖拽文件
   - 支持 .xlsx 和 .xls 格式

3. **配置合并选项**
   - 选择要合并的列
   - 选择分隔符（默认换行符）
   - 配置其他选项

4. **预览和下载**
   - 查看合并结果预览
   - 点击下载CSV文件

## 📋 功能说明

### 支持的功能

- ✅ 多sheet页合并
- ✅ 自定义列选择
- ✅ 多种分隔符（换行符、逗号、分号、自定义）
- ✅ 跳过空单元格选项
- ✅ 全选/取消全选
- ✅ 实时预览（前10行）
- ✅ 拖拽上传
- ✅ 错误提示
- ✅ 加载动画
- ✅ 重新配置

### 合并规则

- 对于选中的列：将所有sheet中相同位置的单元格值用分隔符连接
- 对于未选中的列：使用第一个sheet的值
- 保持原始数据顺序（按sheet顺序）

## 🧪 测试

### 快速测试

```bash
# 打开应用
open index.html

# 使用测试文件
# 上传 input/基础架构工作周报.xlsx
```

### 自动化测试

```bash
# 打开测试验证工具
open test-validation.html

# 查看测试结果（应该显示28/28通过）
```

### 测试文档

- 📖 [快速测试指南](QUICK-TEST-GUIDE.md) - 5分钟快速测试
- 📊 [测试总结](TESTING-SUMMARY.md) - 完整测试报告
- 📝 [测试计划](test-plan.md) - 详细测试用例
- 🌐 [浏览器兼容性](browser-compatibility-report.md) - 浏览器测试结果
- 📄 [CSV验证](csv-validation-report.md) - CSV输出验证

### 测试结果

- ✅ 自动化测试: 28/28 通过 (100%)
- ✅ Chrome浏览器: 完全兼容
- ✅ CSV输出: 符合RFC 4180标准
- ✅ 代码质量: 优秀

## 🌐 浏览器支持

### 推荐浏览器
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### 最低支持版本
- Chrome 80+
- Firefox 78+
- Safari 13+
- Edge 80+

### 不支持
- Internet Explorer (所有版本)

## 📁 项目结构

```
.
├── index.html              # 主应用页面
├── css/                    # 样式文件
│   ├── base.css           # 基础样式
│   ├── layout.css         # 布局样式
│   └── components.css     # 组件样式
├── js/                     # JavaScript文件
│   ├── ErrorTypes.js      # 错误类型定义
│   ├── ExcelParser.js     # Excel解析器
│   ├── DataMerger.js      # 数据合并器
│   ├── CSVGenerator.js    # CSV生成器
│   ├── AppController.js   # 应用控制器
│   └── main.js            # 主入口
├── input/                  # 测试文件目录
└── test-*.md              # 测试文档
```

## 🔧 技术栈

- **HTML5** - 页面结构
- **CSS3** - 样式和布局
- **Vanilla JavaScript (ES6+)** - 核心逻辑
- **SheetJS (xlsx.js)** - Excel文件解析

### 使用的API
- FileReader API - 读取文件
- Blob API - 创建二进制对象
- URL.createObjectURL - 生成下载链接
- Drag and Drop API - 拖拽上传

## 📖 使用示例

### 示例1: 合并员工信息

假设有3个sheet，每个sheet包含不同部门的员工信息：

**Sheet1 (研发部)**:
| 姓名 | 职位 | 邮箱 |
|------|------|------|
| 张三 | 工程师 | zhang@example.com |

**Sheet2 (市场部)**:
| 姓名 | 职位 | 邮箱 |
|------|------|------|
| 李四 | 经理 | li@example.com |

**Sheet3 (财务部)**:
| 姓名 | 职位 | 邮箱 |
|------|------|------|
| 王五 | 会计 | wang@example.com |

**合并结果** (选择"姓名"列合并):
| 姓名 | 职位 | 邮箱 |
|------|------|------|
| 张三<br>李四<br>王五 | 工程师 | zhang@example.com |

### 示例2: 合并周报数据

将多个周的工作周报合并到一个文件中，方便查看和分析。

## ⚙️ 配置选项

### 分隔符选项
- **换行符 (\n)** - 默认，适合在Excel中查看
- **逗号 (,)** - 适合简单列表
- **分号 (;)** - 适合包含逗号的数据
- **竖线 (|)** - 适合表格式数据
- **自定义** - 输入任意分隔符

### 其他选项
- **跳过空单元格** - 合并时忽略空值（默认启用）

## 🐛 已知限制

- 建议文件大小不超过10MB
- 建议行数不超过10,000行
- 移动浏览器体验可能受限
- 不支持Excel公式（只处理值）

## 🔒 隐私和安全

- ✅ 所有数据处理在浏览器本地完成
- ✅ 不向任何服务器上传数据
- ✅ 不使用任何第三方分析工具
- ✅ 不收集任何用户信息

## 📄 CSV输出说明

### 编码
- 使用UTF-8 with BOM编码
- 确保Excel正确识别中文

### 格式
- 符合RFC 4180标准
- 使用逗号作为字段分隔符
- 使用\r\n作为行分隔符

### 特殊字符处理
- 包含逗号的值用双引号包裹
- 双引号转义为两个双引号
- 换行符保留在值中

## 🤝 贡献

欢迎提交问题和改进建议！

## 📝 许可证

MIT License

## 📞 支持

如有问题，请查看：
- [快速测试指南](QUICK-TEST-GUIDE.md)
- [测试文档](TEST-README.md)
- [常见问题](test-plan.md)

---

**版本**: 1.0
**最后更新**: 2025-11-02
**测试状态**: ✅ 全部通过
